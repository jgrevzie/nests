




%h1 Home Page for #{@nurse.first_name} 
%pre (username #{@nurse.username})

= form_for @nurse, remote: true do |f|
  %fieldset
    %legend#updateMe Personal Info
    = f.label :designation
    .watchMe= f.text_field :designation

    = f.label :comments, "Previous Experience & Other Comments"
    .watchMe= f.text_area :comments, cols: 40, rows: 4

:javascript
  $('.watchMe').change( function() { $(this).parents('form:first').submit(); } );
  $(function() {
    $( "#accordion" ).accordion({collapsible: true, heightStyle: "content"});
  });

#accordion
  %h3#pendingHeader Procedures awaiting validation (#{@nurse.pending_procs.count})
  - if @nurse.pending_procs.count>0
    %table#pendingValidationsTable{border: 1}
      %tr
        %th Procedure
        %th Date
      - @nurse.pending_procs.each do |comp_proc|
        %tr
          %td 
            %a{href: edit_completed_proc_path(comp_proc)}
              = comp_proc.procedure.name
              = "(#{comp_proc.quantity})" if comp_proc.quantity>1

          %td= comp_proc.date_start
  - else
    %em Nothing waiting for validation.

  %h3#rejectedHeader Invalid procedures (#{@nurse.rejected_procs.count})
  - if @nurse.rejected_procs.count>0
    %table#rejectedTable{border: 1}
      %tr
        %th Procedure
        %th Date
      - @nurse.rejected_procs.each do |comp_proc|
        %tr
          %td
            %a.rejected{href: edit_completed_proc_path(comp_proc)}
              = comp_proc.procedure.name
              = "(#{comp_proc.quantity})" if comp_proc.quantity>1
          %td= comp_proc.date_start
  - else
    %em None of your procedures are invalid.

  %h3#summaryHeader Summary of your completed procs (#{@nurse.completed_procs_total})
  - if @nurse.completed_procs_total>0
    %table#summaryTable{border: 1}
      %tr
        %th Procedure
        %th How many
      - @nurse.completed_procs_summary.each do |proc_name, count|
        - next unless count>0
        %tr
          %td #{proc_name}
          %td #{count}
  - else
    %em No completed procedures yet.

:css
  a.rejected  {
    color: red;
  }